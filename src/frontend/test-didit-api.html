<!DOCTYPE html>
<html>
	<head>
		<title>Test Didit API</title>
	</head>
	<body>
		<h1>Test Didit KYC API</h1>
		<button onclick="testDiditAPI()">Test Create Session</button>
		<pre id="result"></pre>

		<script>
			async function testDiditAPI() {
				const result = document.getElementById('result')
				result.textContent = 'Testing...\n'

				const payload = {
					workflow_id: '5f32d046-a7e2-4429-b318-523f3f1b5487',
					vendor_data: `test-${Date.now()}`,
					metadata: {
						created: new Date().toISOString(),
						purpose: 'Restaurant Owner Identity Verification',
						extract_data: true,
						user_id: 'test-user',
					},
					contact_details: {
						email: 'test@example.com',
						email_lang: 'vi',
						phone: '+84987654321',
					},
				}

				result.textContent += 'Payload:\n' + JSON.stringify(payload, null, 2) + '\n\n'

				try {
					const response = await fetch('https://verification.didit.me/v2/session/', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json',
							'X-Api-Key': '7hwmBAe7gzf8RECVEc5oZWQc8Sp9_SDpX9lkLiHUyMs',
						},
						body: JSON.stringify(payload),
					})

					const data = await response.json()

					result.textContent += `Status: ${response.status}\n\n`
					result.textContent += 'Response:\n' + JSON.stringify(data, null, 2)

					if (response.ok) {
						result.textContent += '\n\n✅ SUCCESS!'
					} else {
						result.textContent += '\n\n❌ ERROR - This is the real error from Didit API!'
					}
				} catch (error) {
					result.textContent += '❌ Network Error:\n' + error.message
				}
			}
		</script>
	</body>
</html>
